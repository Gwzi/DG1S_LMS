{% extends 'base.html' %}
{% load static %}
{% block content %}
	<h1>글자수 세기(나이스)</h1>
	<textarea id="textInput" placeholder="여기에 글을 입력하세요..." style="width: 100%;height: 200px;"></textarea>
    <div class="results">
        <p>글자 수: <span id="charCount">0</span></p>
        <p>바이트 수: <span id="byteCount">0</span></p>
        <p>맞춤법 검사 결과: <span id="spellCheckResult">검사 전</span></p>
    </div>
    <script>
        document.getElementById('textInput').addEventListener('input', updateCounts);

        function updateCounts() {
            const text = document.getElementById('textInput').value;
            document.getElementById('charCount').innerText = text.length;
            document.getElementById('byteCount').innerText = new Blob([text]).size;
            checkSpelling(text);
        }

        async function checkSpelling(text) {
            try {
                const response = await fetch("{% url 'pybo:spellcheck' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ text: text })
                });
                const result = await response.json();
                const errors = result.errors.length > 0 ? result.errors.map(err => ` => `).join(', ') : '맞춤법 오류 없음';
                document.getElementById('spellCheckResult').innerText = errors;
            } catch (error) {
                document.getElementById('spellCheckResult').innerText = '맞춤법 검사 실패';
            }
        }
    </script>

{% endblock %}
